name: Variaveis no n√≠vel do workflow
on: push
env:
  CONTAINER_REGISTRY: docker.io
  IMAGE_NAME: github_actions_nginx
jobs:
  
  docker:
      if: github.ref == 'refs/heads/main'
      runs-on: ubuntu-latest
      steps:
         - name: Fazendo build da imagem Docker
           timeout-minutes: 1
           run: echo docker build -t $CONTAINER_REGISTRY/${{ vars.DOCKER_USERNAME }}/$IMAGE_NAME:latest .

         - name: Fazendo login no Docker Hub
           run: echo docker login --username=${{ vars.DOCKER_USERNAME }} --password=${{ secrets.DOCKER_PASSWORD }}

         - name: Fazendo o upload da image Docker
           timeout-minutes: 1
           run: |
             echo docker push $CONTAINER_REGISTRY/${{ vars.DOCKER_USERNAME }}/$IMAGE_NAME:latest
             sleep 120